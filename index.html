<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Estimation Calculator</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: white;
            color: #333;
            margin: 0;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h2 {
            color: #1a1a1a;
        }
        form {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            width: 300px;
            box-sizing: border-box;
        }
        input, select {
            width: 100%;
            padding: 8px;
            margin-top: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }
        input:hover, select:hover {
            border-color: #88aaff;
        }
        button {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 4px;
            background-color: #007aff;
            color: white;
            font-size: 16px;
            cursor: pointer;
            margin-top: 12px;
        }
        button:hover {
            background-color: #005ecb;
        }
        footer {
            margin-top: 20px;
            font-size: 12px;
            color: #666;
        }
        .result-container {
            margin-top: 20px;
            text-align: center;
        }
        .calculated-time {
            font-size: 45px;
            font-weight: bold;
            background: linear-gradient(to top right, rgba(19, 53, 173, 1), rgba(39, 137, 207, 1));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
        }
        .dropdowns-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<h2 style="font-size: 45px; font-weight: bold; background: linear-gradient(to top right, rgba(19, 53, 173, 1), rgba(39, 137, 207, 1)); -webkit-background-clip: text; background-clip: text; color: transparent; display: inline-block;">General model to estimate interchange time</h2>
<p style="font-size: 18px;">
    Model created to estimate the interchange time between metro lines. More information about the project <a href="https://wordpress.com/post/omtsprojects.wordpress.com/228">here</a>.
</p>

<form id="timeEstimationForm">
    <div>
        <label for="walkDistance">Walking Distance (meters):</label>
        <input type="number" id="walkDistance" name="walkDistance" placeholder="Total distance to walk">
    </div>

    <div>
        <label for="escalatorDistance">Escalator length (Steps):</label>
        <input type="number" id="escalatorDistance" name="escalatorDistance" placeholder="Based on stairs next to it">
    </div>

    <div>
        <label for="numSteps">Stairs length (Steps):</label>
        <input type="number" id="numSteps" name="numSteps" placeholder="Only if no escalator">
    </div>

    <div>
        <label for="walkwayLength">Moving Walkway Length (meters):</label>
        <input type="number" id="walkwayLength" name="walkwayLength" placeholder="Can't be in walking distance">
    </div>

    <div>
        <label for="metroStation">Select Metro Station:</label>
        <select id="metroStation" onchange="showDropdowns()">
            <option value="custom">Custom Station</option>
            <option value="sants">Sants Estaci√≥</option>
            <option value="diagonal">Diagonal</option>
        </select>
    </div>

    <div id="dropdownsContainer" class="dropdowns-container" style="display: none;">
        <div>
            <label for="startPlatform">Start Platform:</label>
            <select id="startPlatform">
                <!-- Options will be populated dynamically -->
            </select>
        </div>
        <div>
            <label for="destinationPlatform">Destination Platform:</label>
            <select id="destinationPlatform">
                <!-- Options will be populated dynamically -->
            </select>
        </div>
        <button type="button" onclick="confirmSelection()" style="background: linear-gradient(to top right, rgba(0, 102, 34, 1), rgba(111, 204, 97, 1)); color: white; font-weight: bold; padding: 10px; border: none; border-radius: 4px; cursor: pointer; transition: background 0.3s;">
            Confirm Selection
        </button>
    </div>

    <button type="button" onclick="calculateTime()" style="background: linear-gradient(to top right, rgba(0, 102, 34, 1), rgba(111, 204, 97, 1)); color: white; font-weight: bold; padding: 10px; border: none; border-radius: 4px; cursor: pointer; transition: background 0.3s;">
        Calculate Time
    </button>
    
</form>

<div class="result-container">
    <p>Your calculated travel time is:</p>
    <p class="calculated-time" id="calculatedTime">0.00</p>
</div>

<script>
    const distances = {
        diagonal: {
            l3_trinitat: { l3_trinitat: 0, l3_zona: 157.89, l5_cornelia: 140.54, l5_hebron: 140.51 },
            l3_zona: { l3_trinitat: 157.89, l3_zona: 0, l5_cornelia: 124.04, l5_hebron: 124.01 },
            l5_cornelia: { l3_trinitat: 140.54, l3_zona: 124.04, l5_cornelia: 0, l5_hebron: 106.66 },
            l5_hebron: { l3_trinitat: 140.51, l3_zona: 124.01, l5_cornelia: 106.66, l5_hebron: 0 }
        },
        sants: {
            l3_trinitat: { l3_trinitat: 0, l3_zona: 123, l5_cornelia: 237.19, l5_hebron: 251.79 },
            l3_zona: { l3_trinitat: 123, l3_zona: 0, l5_cornelia: 248.67, l5_hebron: 263.27 },
            l5_cornelia: { l3_trinitat: 237.19, l3_zona: 248.67, l5_cornelia: 0, l5_hebron: 116.58 },
            l5_hebron: { l3_trinitat: 251.79, l3_zona: 263.27, l5_cornelia: 116.58, l5_hebron: 0 }
        }
    };

    const stairs = {
        diagonal: {
            l3_trinitat: { l3_trinitat: 0, l3_zona: 47, l5_cornelia: 58, l5_hebron: 46 },
            l3_zona: { l3_trinitat: 47, l3_zona: 0, l5_cornelia: 59, l5_hebron: 47 },
            l5_cornelia: { l3_trinitat: 58, l3_zona: 59, l5_cornelia: 0, l5_hebron: 70 },
            l5_hebron: { l3_trinitat: 58, l3_zona: 59, l5_cornelia: 70, l5_hebron: 0 }
        },
        sants: {
            l3_trinitat: { l3_trinitat: 0, l3_zona: 68, l5_cornelia: 34, l5_hebron: 88 },
            l3_zona: { l3_trinitat: 68, l3_zona: 0, l5_cornelia: 34, l5_hebron: 88 },
            l5_cornelia: { l3_trinitat: 34, l3_zona: 34, l5_cornelia: 0, l5_hebron: 54 },
            l5_hebron: { l3_trinitat: 88, l3_zona: 88, l5_cornelia: 54, l5_hebron: 0 }
        }
    };

    function populatePlatforms(station) {
        var startPlatformSelect = document.getElementById('startPlatform');
        var destinationPlatformSelect = document.getElementById('destinationPlatform');

        startPlatformSelect.innerHTML = '';
        destinationPlatformSelect.innerHTML = '';

        var platforms = {
            sants: ["L3 Trinitat", "L3 Zona", "L5 Cornelia", "L5 Hebron"],
            diagonal: ["L3 Trinitat", "L3 Zona", "L5 Cornelia", "L5 Hebron"]
        };

        platforms[station].forEach(function(platform) {
            var option = document.createElement('option');
            option.text = platform;
            option.value = platform.toLowerCase().replace(/\s/g, '_');
            startPlatformSelect.add(option);
        });

        platforms[station].forEach(function(platform) {
            var option = document.createElement('option');
            option.text = platform;
            option.value = platform.toLowerCase().replace(/\s/g, '_');
            destinationPlatformSelect.add(option);
        });

        updatePlatformInfo(); // Update once to set initial values
    }

    function showDropdowns() {
        var station = document.getElementById('metroStation').value;
        var dropdownsContainer = document.getElementById('dropdownsContainer');
        
        if (station === 'custom') {
            dropdownsContainer.style.display = 'none';
        } else {
            dropdownsContainer.style.display = 'block';
            populatePlatforms(station);
        }
    }

    function confirmSelection() {
        var station = document.getElementById('metroStation').value;
        var startPlatform = document.getElementById('startPlatform').value;
        var destinationPlatform = document.getElementById('destinationPlatform').value;

        var presetValues = {
            walkDistance: distances[station][startPlatform][destinationPlatform],
            escalatorDistance: stairs[station][startPlatform][destinationPlatform],
            numSteps: 0, // Preset to zero
            walkwayLength: 0 // Preset to zero
        };

        document.getElementById('walkDistance').value = presetValues.walkDistance;
        document.getElementById('escalatorDistance').value = presetValues.escalatorDistance;
        document.getElementById('numSteps').value = presetValues.numSteps;
        document.getElementById('walkwayLength').value = presetValues.walkwayLength;
    }

    function calculateTime() {
        var walkDistance = parseFloat(document.getElementById('walkDistance').value) || 0;
        var escalatorDistance = parseFloat(document.getElementById('escalatorDistance').value) || 0;
        var numSteps = parseFloat(document.getElementById('numSteps').value) || 0;
        var walkwayLength = parseFloat(document.getElementById('walkwayLength').value) || 0;

        var walkingSpeed = 1.3; // m/s
        var stairsSpeed = 1.9; // steps/s
        var escalatorSpeed = 1.5; // steps/s
        var walkwaySpeed = 0.5; // m/s

        var walkingTime = walkDistance / walkingSpeed;
        var stairsTime = numSteps / stairsSpeed;
        var escalatorTime = escalatorDistance / escalatorSpeed;
        var walkwayTime = walkwayLength / walkwaySpeed;

        var estimatedTime = walkingTime + stairsTime + escalatorTime + walkwayTime;

        document.getElementById('calculatedTime').innerText = estimatedTime.toFixed(2);
    }
</script>
<footer>
    Learn more about this project <a href="https://wordpress.com/post/omtsprojects.wordpress.com/228">here</a>.
</footer>
</body>
</html>
